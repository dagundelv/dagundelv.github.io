+++
title = "开发库与生产库如何隔离与同步：数据库发布规范"
date = 2026-02-28T09:00:00+08:00
draft = false
tags = ["MySQL", "数据库", "发布规范", "运维"]
categories = ["工程实践"]
description = "数据库结构脚本化、数据隔离与上线顺序的标准实践。"
+++

## 1. 三条底线

- 开发库、测试库、生产库必须物理隔离。
- 只同步结构（表/字段/索引），不同步生产业务数据。
- 所有结构变更必须脚本化并纳入版本管理。

## 2. 版本化 SQL 目录

```text
db/
  v1.0_init.sql
  v1.1_add_user_table.sql
  v1.2_add_hospital_field.sql
```

规则：只增不改，按版本顺序执行，确保可追溯与可回滚。

## 3. 标准上线顺序

1. 合并代码到 `main` 前确认 SQL 脚本。
2. 备份生产库（必须）。
3. 执行数据库升级脚本。
4. 部署代码并回归验证。

顺序不能反，尤其不能“先发代码后改库”。

## 4. 禁止操作

- 禁止直接连生产库手工改表。
- 禁止把生产数据拉到本地开发。
- 禁止口头同步字段改动，不留脚本。

一句话：**结构靠脚本同步，数据永远隔离。**
